View(train_dataset)
test_dataset$Drug=factor(test_dataset$Drug,levels=c('Placebo','D-penicillamine'),labels=c(1,2))
test_dataset$Sex=factor(test_dataset$Sex,levels=c('F','M'),labels=c(0,1))
test_dataset$Ascites=factor(test_dataset$Ascites,levels=c('N','Y'),labels=c(1,0))
test_dataset$Hepatomegaly=factor(test_dataset$Hepatomegaly,levels=c('N','Y'),labels=c(1,0))
test_dataset$Spiders=factor(test_dataset$Spiders,levels=c('N','Y'),labels=c(1,0))
test_dataset$Edema=factor(test_dataset$Edema,levels=c('N','Y'),labels=c(1,0))
test_dataset$Prothrombin=ifelse(is.na(test_dataset$Prothrombin),ave(test_dataset$Prothrombin,FUN=function(x) mean(x,na.rm=TRUE)),test_dataset$Prothrombin)
test_dataset$Platelets=ifelse(is.na(test_dataset$Platelets),ave(test_dataset$Platelets,FUN=function(x) mean(x,na.rm=TRUE)),test_dataset$Platelets)
test_dataset$Tryglicerides=ifelse(is.na(test_dataset$Tryglicerides),ave(test_dataset$Tryglicerides,FUN=function(x) mean(x,na.rm=TRUE)),test_dataset$Tryglicerides)
test_dataset$SGOT=ifelse(is.na(test_dataset$SGOT),ave(test_dataset$SGOT,FUN=function(x) mean(x,na.rm=TRUE)),test_dataset$SGOT)
test_dataset$Copper=ifelse(is.na(test_dataset$Copper),ave(test_dataset$SGOT,FUN=function(x) mean(x,na.rm=TRUE)),test_dataset$Copper)
test_dataset$Copper=ifelse(is.na(test_dataset$Copper),ave(test_dataset$SGOT,FUN=function(x) mean(x,na.rm=TRUE)),test_dataset$Copper)
test_dataset$Alk_Phos=ifelse(is.na(test_dataset$Alk_Phos),ave(test_dataset$Alk_Phos,FUN=function(x) mean(x,na.rm=TRUE)),test_dataset$Alk_Phos)
train_dataset$Drug=factor(train_dataset$Drug,levels=c('Placebo','D-penicillamine'),labels=c(1,2))
train_dataset$Sex=factor(train_dataset$Sex,levels=c('F','M'),labels=c(0,1))
train_dataset$Ascites=factor(train_dataset$Ascites,levels=c('N','Y'),labels=c(1,0))
train_dataset$Hepatomegaly=factor(train_dataset$Hepatomegaly,levels=c('N','Y'),labels=c(1,0))
train_dataset$Spiders=factor(train_dataset$Spiders,levels=c('N','Y'),labels=c(1,0))
train_dataset$Edema=factor(train_dataset$Edema,levels=c('N','Y'),labels=c(1,0))
train_dataset$Prothrombin=ifelse(is.na(train_dataset$Prothrombin),ave(train_dataset$Prothrombin,FUN=function(x) mean(x,na.rm=TRUE)),train_dataset$Prothrombin)
train_dataset$Platelets=ifelse(is.na(train_dataset$Platelets),ave(train_dataset$Platelets,FUN=function(x) mean(x,na.rm=TRUE)),train_dataset$Platelets)
train_dataset$Tryglicerides=ifelse(is.na(train_dataset$Tryglicerides),ave(train_dataset$Tryglicerides,FUN=function(x) mean(x,na.rm=TRUE)),train_dataset$Tryglicerides)
train_dataset$SGOT=ifelse(is.na(train_dataset$SGOT),ave(train_dataset$SGOT,FUN=function(x) mean(x,na.rm=TRUE)),train_dataset$SGOT)
train_dataset$Copper=ifelse(is.na(train_dataset$Copper),ave(train_dataset$SGOT,FUN=function(x) mean(x,na.rm=TRUE)),train_dataset$Copper)
train_dataset$Copper=ifelse(is.na(train_dataset$Copper),ave(train_dataset$SGOT,FUN=function(x) mean(x,na.rm=TRUE)),train_dataset$Copper)
train_dataset$Alk_Phos=ifelse(is.na(train_dataset$Alk_Phos),ave(train_dataset$Alk_Phos,FUN=function(x) mean(x,na.rm=TRUE)),train_dataset$Alk_Phos)
regressor=lm(formula=Stage~.,data=train_dataset)
summary(regressor)
y_pred=predict(regressor,newdata=test_dataset)
y_pred
